# Canards Processor Board Firmware

 Firmware for the 2024-2025 processor board, performing state estimation and control for the canards system.
 Project documentation can be found in the team Google Drive.

## Setup
1. Clone repo and initialize submodules `git clone --recurse-submodules git@github.com:waterloo-rocketry/cansw_processor_canards.git`
2. Open project in STM32CubeIDE (recommended IDE)
3. Use ST-Link to flash code to processor board

## Project Structure
- `src/drivers/`: custom peripheral driver modules
- `src/application/`: high-level application logic modules
- `src/third_party/`: third-party libraries
- `src/common/`: shared resources specific to this project
- Everything else is autogenerated by STM32CubeIDE with few modifications


## Unit Test Environment Setup

### Required Dependencies

#### 1. CMake

**Ubuntu/Debian:**

```bash
sudo apt-get update
sudo apt-get install cmake
```

**macOS:**

- Install Command Line Tools(includes Clang compiler):
   ```bash
   xcode-select --install
   ```
- Install Homebrew(if not already installed):
   ```bash
   /bin/bash -c "$(curl -fsSL https://raw.githubusercontent.com/Homebrew/install/HEAD/install.sh)"
   ```
- Install CMake using Homebrew:
   ```bash
   brew install cmake
   ```

**Windows:**

- Install [Chocolatey](https://chocolatey.org/install#individual)
- Use Chocolatey to install Make and MinGW64:
```bash
choco install -y make
choco install -y mingw
```

#### 2. Google Test

- Automatically fetched and configured by CMake during build

## Using the Test Script

On Linux/Mac: make the test script executable:

```bash
chmod +x scripts/test.sh
```
On Windows, simply use Git Bash or another bash shell to run the following commands. 

### Available Commands

- Build the project:

  ```bash
  ./scripts/test.sh build
  ```

- Run tests:

  ```bash
  ./scripts/test.sh test
  ```

- Clean build directory:

  ```bash
  ./scripts/test.sh clean
  ```

- Run full pipeline (clean, build, test):

  ```bash
  ./scripts/test.sh all
  ```

- Show help:

  ```bash
  ./scripts/test.sh help
  ```
